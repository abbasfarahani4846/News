@using News.Models.Helpers
@model News.Models.ViewModels.NewsDetailsViewModel

<style>
    .longContent img {
        max-width: 100%
    }
</style>
<!-- Single Product Start -->
<div class="container-fluid py-5">
    <div class="container py-5">
        <ol class="breadcrumb justify-content-start mb-4">
            <li class="breadcrumb-item"><a href="/">Home</a></li>
            <li class="breadcrumb-item"><a href="/news">News</a></li>
            <li class="breadcrumb-item active text-dark">
                @Model.News.Title
            </li>
        </ol>
        <div class="row g-4">
            <div class="col-lg-8">
                <div class="mb-4">
                    <a href="/news/@Model.News.Id" class="h1 display-5">
                        @Model.News.Title
                    </a>
                </div>
                <div class="position-relative rounded overflow-hidden mb-3">
                    <img src="/images/news/@Model.News.ImageName" class="img-zoomin img-fluid rounded w-100" alt="@Model.News.Title">
                    <div class="position-absolute text-white px-4 py-2 bg-primary rounded" style="top: 20px; right: 20px;">
                        @Model.Category.Title
                    </div>
                </div>
                <div class="d-flex justify-content-between">
                    <a class="text-dark link-hover me-3"><i class="fa fa-clock"></i> @Model.ReadingTimeInMinutes minute read</a>
                    <a class="text-dark link-hover me-3"><i class="fa fa-eye"></i> @Model.News.ViewCount Views</a>
                    <a class="text-dark link-hover me-3"><i class="fa fa-comment-dots"></i> @Model.Comments.Count() Comment</a>
                </div>


                <div class="longContent">
                    @Html.Raw(Model.News.LongDescription)
                </div>


                <div class="tab-class">
                    <div class="d-flex justify-content-between border-bottom mb-4">
                        <ul class="nav nav-pills d-inline-flex text-center">
                            <li class="nav-item mb-3">
                                <h5 class="mt-2 me-3 mb-0">Tags:</h5>
                            </li>
                            @if (!string.IsNullOrEmpty(Model.News.Tags))
                            {
                                var tags = Model.News.Tags.Split(",").ToList();

                                foreach (var item in tags)
                                {
                                    <li class="nav-item mb-3">
                                        <a class="d-flex py-2 bg-light rounded-pill active me-2" data-bs-toggle="pill" href="/news?tag=@item">
                                            <span class="text-dark" style="width: 100px;">
                                                @item
                                            </span>
                                        </a>
                                    </li>
                                }

                            }
                        </ul>
                        <div class="d-flex align-items-center">
                            <h5 class="mb-0 me-3">Share:</h5>
                            <a href="https://www.facebook.com">
                                <i class="fab fa-facebook-f link-hover btn btn-square rounded-circle border-primary text-dark me-2"></i>
                            </a>
                            <a href="https://www.x.com">
                                <i class="btn fab bi-twitter link-hover btn btn-square rounded-circle border-primary text-dark me-2"></i>
                            </a>
                            <a href="https://instagram.com">
                                <i class="btn fab fa-instagram link-hover btn btn-square rounded-circle border-primary text-dark me-2"></i>
                            </a>
                            <a href="https://www.linkedin.com/">
                                <i class="btn fab fa-linkedin-in link-hover btn btn-square rounded-circle border-primary text-dark"></i>
                            </a>

                        </div>
                    </div>
                </div>

                <div class="bg-light rounded my-4 p-4">
                    <h4 class="mb-4">You Might Also Like</h4>
                    <div class="row g-4">
                        @if (Model.RelatedNews.Any())
                        {
                            @foreach (var item in Model.RelatedNews)
                            {
                                <div class="col-lg-6">
                                    <div class="d-flex align-items-center p-3 bg-white rounded">
                                        <img src="img/chatGPT.jpg" class="img-fluid rounded" alt="">
                                        <div class="ms-3">
                                            <a href="/news/@item.Id" class="h5 mb-2">
                                                @item.Title
                                            </a>
                                            <p class="text-dark mt-3 mb-0 me-3">
                                                <i class="fa fa-clock"></i>
                                                @TextHelpers.CalculateReadingTime(item.LongDescription) minute read
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            }
                        }

                    </div>
                </div>
                <div class="bg-light rounded p-4">
                    <h4 class="mb-4">Comments</h4>
                    @if (Model.RelatedNews.Any())
                    {
                        foreach (var item in Model.Comments)
                        {
                            <div class="p-4 bg-white rounded mb-4">
                                <div class="row g-4">
                                    <div class="col-3">
                                        <img src="/images/user.png" class="img-fluid rounded-circle w-100" alt="">
                                    </div>
                                    <div class="col-9">
                                        <div class="d-flex justify-content-between">
                                            <h5>
                                                @item.FullName
                                            </h5>
                                            @* <a href="#" class="link-hover text-body fs-6"><i class="fas fa-long-arrow-alt-right me-1"></i> Reply</a> *@
                                        </div>
                                        <small class="text-body d-block mb-3"><i class="fas fa-calendar-alt me-1"></i> @item.CreatedAt.ToString("MMM d, yyyy");</small>
                                        <p class="mb-0">
                                            @item.CommentText
                                        </p>
                                    </div>
                                </div>
                            </div>
                        }
                    }

                </div>
                <div class="bg-light rounded p-4 my-4">
                    <h4 class="mb-4">Leave A Comment</h4>
                    @{
                        var commentModel = new News.Models.Db.Comment
            {
                NewsId = Model.News.Id
            };
                    }

                    <form action="/news/SubmitComment" method="post" id="comment-form">
                        @Html.AntiForgeryToken()
                        <input type="hidden" asp-for="@commentModel.NewsId" />

                        @if (TempData["SuccessMessage"] != null)
                        {
                            <div class="alert alert-success">@TempData["SuccessMessage"]</div>
                        }
                        @if (TempData["ErrorMessage"] != null)
                        {
                            <div class="alert alert-danger">@TempData["ErrorMessage"]</div>
                        }

                        <div class="row g-4">
                            <div class="col-lg-6">
                                <input type="text" asp-for="@commentModel.FullName" class="form-control py-3" placeholder="Full Name">
                                <span asp-validation-for="@commentModel.FullName" class="text-danger"></span>
                            </div>
                            <div class="col-lg-6">
                                <input type="email" asp-for="@commentModel.Email" class="form-control py-3" placeholder="Email Address">
                                <span asp-validation-for="@commentModel.Email" class="text-danger"></span>
                            </div>
                            <div class="col-12">
                                <textarea asp-for="@commentModel.CommentText" class="form-control" rows="7" placeholder="Write Your Comment Here"></textarea>
                                <span asp-validation-for="@commentModel.CommentText" class="text-danger"></span>
                            </div>
                            <div class="col-12">
                                <button class="form-control btn btn-primary py-3" type="submit">Submit Now</button>
                            </div>
                        </div>
                    </form>

                </div>
            </div>
            <div class="col-lg-4">
                <div class="row g-4">
                    <div class="col-12">
                        <div class="p-3 rounded border">
                            <form method="get" action="/news">
                                <div class="input-group w-100 mx-auto d-flex mb-4">
                                    <input type="search" name="searchTerm" class="form-control p-3" placeholder="keywords" aria-describedby="search-icon-1">
                                    <span id="search-icon-1" class="btn btn-primary input-group-text p-3">
                                        <i class="fa fa-search text-white"></i>
                                    </span>
                                </div>
                            </form>
                            <h4 class="mb-4">Popular Categories</h4>
                            <div class="row g-2">
                                @foreach (var item in Model.Categories)
                                {
                                    <div class="col-12">
                                        <a href="/news?categoryId=@item.Id" class="link-hover btn btn-light w-100 rounded text-uppercase text-dark py-3">
                                            @item.Title
                                        </a>
                                    </div>
                                }
                            </div>
                            <h4 class="my-4">Popular News</h4>
                            <div class="row g-4">
                                @foreach (var item in Model.Popular)
                                {
                                    <div class="col-12">
                                        <div class="row g-4 align-items-center features-item">
                                            <div class="col-4">
                                                <div class="rounded-circle position-relative">
                                                    <div class="overflow-hidden rounded-circle">
                                                        <img src="/images/news/thumb_@item.ImageName" class="img-zoomin img-fluid rounded-circle w-100" alt="@item.Title">
                                                    </div>
                                                    <span class="rounded-circle border border-2 border-white bg-primary btn-sm-square text-white position-absolute" style="top: 10%; right: -10px;">
                                                        @item.ViewCount
                                                    </span>
                                                </div>
                                            </div>
                                            <div class="col-8">
                                                <div class="features-content d-flex flex-column">
                                                    <a href="/news/@item.Id" class="h6">
                                                        @item.Title
                                                    </a>
                                                    <small class="text-body d-block">
                                                        <i class="fas fa-calendar-alt me-1"></i>
                                                        @item.CreatedAt?.ToString("MMM d, yyyy")
                                                    </small>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                }
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Single Product End -->
